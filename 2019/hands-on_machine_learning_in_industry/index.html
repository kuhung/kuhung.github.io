<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="谷粒">
  <meta name="description" content="数据挖掘/机器学习工程师">
  <meta name="keywords" content="华中科技大学,谷粒,谷粒粒,数据挖掘,网易游戏,米哈游,广告投放,用户分析,增长黑客,开发者,极客,代码,开源,Developer,Programmer,Coder,Geek,DataScientist">
  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-76017508-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
  <link rel="prev" href="https://kuhungio.me/2019/slack-gpt2-bot/" />
  <link rel="next" href="https://kuhungio.me/2019/vgc-it/" />
  <link rel="canonical" href="https://kuhungio.me/2019/hands-on_machine_learning_in_industry/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           机器学习项目的完整生命周期 Hands On Machine Learning in Industry  | 谷粒的博客
       
  </title>
  <meta name="title" content="机器学习项目的完整生命周期 Hands On Machine Learning in Industry  | 谷粒的博客">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/kuhungio.me"
    },
    "articleSection" : "posts",
    "name" : "机器学习项目的完整生命周期 Hands On Machine Learning in Industry ",
    "headline" : "机器学习项目的完整生命周期 Hands On Machine Learning in Industry ",
    "description" : "机器学习这东西，在学术界产出颇多，但在工业界，却很少落地。究其原因，是理念落地不够彻底，很多从业者和相关上下游不理解所致。这次就这这个机会，梳理下一个机器学习，从立项到落地再到结束，他的完整生命周期该是什么样子的。这里参考了《Hands-On Machine Learning with Scikit-Learn and Tensorflow》，值得一提的是这本书写的很不错，和《集体智慧编程》有一拼，建议阅读英文原著或东南大学出的影印版。\n机器学习项目的生命周期  问题定义   定义问题，并关注大局   数据处理\n 获取数据 探索性的数据分析 清洗数据，为接下来的模型做准备    模型方案\n 探索不同的模型并挑选合适的模型 对模型进行微调，并集成为更好的模型 解决方案呈现    部署维护\n 部署、监控并维护系统    定义问题，从大局出发  和业务团队一起定义问题目标 我们的解决方案将会如何发挥作用 现在的解决方案是什么样的（如果有） 你将如何定义这个问题（有监督、无监督，在线还是离线） 结果该如何衡量 衡量方法是否和商业目标一致 要达成这一目标，至少的表现该是什么样子的 类似的问题是什么？有无可复用的经验与工具 我们有专家知识吗 你将如何着手解决这个问题 列出你或者别人目前所作的努力 如果可能，对假说进行验证  获取数据 建议：尽量自动化以更容易地方式获取最新的数据\n 列出你所需的数据以及体量 找寻并记录下获取数据的方式 检查数据将占据多少空间 检查是否有法律风险，如有必要请获得许可 获取许可 创建工作空间，确保存储足够大 获取数据 转换数据的格式以便能够方便操作（不需要改变数据本身） 确保敏感信息被删除或保护加密（匿名） 检查数据的大小和类型（时间序列、采样、地理信息等） 划分测试集，把他放一边，并且不再去动他（防止数据泄露）  探索数据 建议：在该阶段尽量获取领域专家的意见\n 创建数据的副本以便做数据探索（如果数据量太大，做降采样处理） 创建 Jupyter notebook 以便保存探索记录 研究每个属性及其特征  名称 类型（类别，整型\/浮点，有无上下界，文本，结构化等） 缺失值 噪声数据（随机数，异常值，四舍五入的误差） 对本任务可能有用的数据 分布类型（高斯分布，均匀分布，指数分布）   对于有监督问题：确定目标对象 可视化数据 研究变量间的相关性 研究你将如何着手解决此问题 确认比较有希望的解决方案 确认有用的外部数据 将以上信息存档记录下来  准备数据 建议：",
    "inLanguage" : "zh-CN",
    "author" : "谷粒",
    "creator" : "谷粒",
    "publisher": "谷粒",
    "accountablePerson" : "谷粒",
    "copyrightHolder" : "谷粒",
    "copyrightYear" : "2019",
    "datePublished": "2019-04-01 19:28:32 \u002b0800 CST",
    "dateModified" : "2019-04-01 19:28:32 \u002b0800 CST",
    "url" : "https:\/\/kuhungio.me\/2019\/hands-on_machine_learning_in_industry\/",
    "wordCount" : "130",
    "keywords" : [ "机器学习进阶", "谷粒的博客"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://kuhungio.me">谷粒的博客</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">历史博文</a>
                
                <a class="menu-item" href="/tags/mindmap/" title="">思维导图</a>
                
                <a class="menu-item" href="/about/" title="关于我">关于我</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://kuhungio.me">谷粒的博客</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">历史博文</a>
                
                <a class="menu-item" href="/tags/mindmap/" title="">思维导图</a>
                
                <a class="menu-item" href="/about/" title="关于我">关于我</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">机器学习项目的完整生命周期 Hands On Machine Learning in Industry </h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://kuhungio.me" rel="author">谷粒</a> with ♥
                <span class="post-time">
                on <time datetime=2019-04-01 itemprop="datePublished">April 1, 2019</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://kuhungio.me/categories/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"> 数据挖掘/机器学习 </a>
                        
                </span>

                |
                <a href="#gitalk-container" itemprop="discussionUrl">
                    <span class="gitalk-comment-count" itemprop="commentCount"></span>
                </a>
                条评论
        </div>
    </header>

        <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title"></h2>
  
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#定义问题从大局出发">定义问题，从大局出发</a></li>
    <li><a href="#获取数据">获取数据</a></li>
    <li><a href="#探索数据">探索数据</a></li>
    <li><a href="#准备数据">准备数据</a></li>
    <li><a href="#挑选合适的模型">挑选合适的模型</a></li>
    <li><a href="#微调系统">微调系统</a></li>
    <li><a href="#方案呈现">方案呈现</a></li>
    <li><a href="#部署">部署</a></li>
  </ul>
</nav>
  </div>
</div>

<script type="text/javascript">
  window.onload = function () {
    var fix = $('.post-toc');
    var end = $('.post-comment');
    var fixTop = fix.offset().top, fixHeight = fix.height();
    var endTop, miss;
    var offsetTop = fix[0].offsetTop;

    $(window).scroll(function () {
      var docTop = Math.max(document.body.scrollTop, document.documentElement.scrollTop);

      if (end.length > 0) {
        endTop = end.offset().top;
        miss = endTop - docTop - fixHeight;
      }

      if (fixTop < docTop) {
        fix.css({ 'position': 'fixed' });
        if ((end.length > 0) && (endTop < (docTop + fixHeight))) {
          fix.css({ top: miss });
        } else {
          fix.css({ top: 0 });
        }
      } else {
        fix.css({ 'position': 'absolute' });
        fix.css({ top: offsetTop });
      }
    })
  }
</script>

    <div class="post-content">
        

        

        
        

          
          
          

          
          
          

          <p>机器学习这东西，在学术界产出颇多，但在工业界，却很少落地。究其原因，是理念落地不够彻底，很多从业者和相关上下游不理解所致。这次就这这个机会，梳理下一个机器学习，从立项到落地再到结束，他的完整生命周期该是什么样子的。这里参考了《Hands-On Machine Learning with Scikit-Learn and Tensorflow》，值得一提的是这本书写的很不错，和《集体智慧编程》有一拼，建议阅读英文原著或东南大学出的影印版。</p>
<h1 id="机器学习项目的生命周期">机器学习项目的生命周期</h1>
<ol>
<li>问题定义</li>
</ol>
<ul>
<li><input checked="" disabled="" type="checkbox"> 定义问题，并关注大局</li>
</ul>
<ol start="2">
<li>
<p>数据处理</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> 获取数据</li>
<li><input checked="" disabled="" type="checkbox"> 探索性的数据分析</li>
<li><input checked="" disabled="" type="checkbox"> 清洗数据，为接下来的模型做准备</li>
</ul>
</li>
<li>
<p>模型方案</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> 探索不同的模型并挑选合适的模型</li>
<li><input checked="" disabled="" type="checkbox"> 对模型进行微调，并集成为更好的模型</li>
<li><input checked="" disabled="" type="checkbox"> 解决方案呈现</li>
</ul>
</li>
<li>
<p>部署维护</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> 部署、监控并维护系统</li>
</ul>
</li>
</ol>
<h2 id="定义问题从大局出发">定义问题，从大局出发</h2>
<ol>
<li>和业务团队一起定义问题目标</li>
<li>我们的解决方案将会如何发挥作用</li>
<li>现在的解决方案是什么样的（如果有）</li>
<li>你将如何定义这个问题（有监督、无监督，在线还是离线）</li>
<li>结果该如何衡量</li>
<li>衡量方法是否和商业目标一致</li>
<li>要达成这一目标，至少的表现该是什么样子的</li>
<li>类似的问题是什么？有无可复用的经验与工具</li>
<li>我们有专家知识吗</li>
<li>你将如何着手解决这个问题</li>
<li>列出你或者别人目前所作的努力</li>
<li>如果可能，对假说进行验证</li>
</ol>
<h2 id="获取数据">获取数据</h2>
<p>建议：尽量自动化以更容易地方式获取最新的数据</p>
<ol>
<li>列出你所需的数据以及体量</li>
<li>找寻并记录下获取数据的方式</li>
<li>检查数据将占据多少空间</li>
<li>检查是否有法律风险，如有必要请获得许可</li>
<li>获取许可</li>
<li>创建工作空间，确保存储足够大</li>
<li>获取数据</li>
<li>转换数据的格式以便能够方便操作（不需要改变数据本身）</li>
<li>确保敏感信息被删除或保护加密（匿名）</li>
<li>检查数据的大小和类型（时间序列、采样、地理信息等）</li>
<li>划分测试集，把他放一边，并且不再去动他（防止数据泄露）</li>
</ol>
<h2 id="探索数据">探索数据</h2>
<p>建议：在该阶段尽量获取领域专家的意见</p>
<ol>
<li>创建数据的副本以便做数据探索（如果数据量太大，做降采样处理）</li>
<li>创建 Jupyter notebook 以便保存探索记录</li>
<li>研究每个属性及其特征
<ul>
<li>名称</li>
<li>类型（类别，整型/浮点，有无上下界，文本，结构化等）</li>
<li>缺失值</li>
<li>噪声数据（随机数，异常值，四舍五入的误差）</li>
<li>对本任务可能有用的数据</li>
<li>分布类型（高斯分布，均匀分布，指数分布）</li>
</ul>
</li>
<li>对于有监督问题：确定目标对象</li>
<li>可视化数据</li>
<li>研究变量间的相关性</li>
<li>研究你将如何着手解决此问题</li>
<li>确认比较有希望的解决方案</li>
<li>确认有用的外部数据</li>
<li>将以上信息存档记录下来</li>
</ol>
<h2 id="准备数据">准备数据</h2>
<p>建议：</p>
<ul>
<li>在数据的副本上操作（保持原始数据不被影响）</li>
<li>将你所作的数据变换写成函数，有以下5个原因
<ul>
<li>便于在本项目的新数据上复用</li>
<li>便于在别的项目中复用</li>
<li>快速清洗和准备测试集</li>
<li>在立项后，能够及时对数据进行处理</li>
<li>让数据变换过程也能作为超参数的一份子，进行调参</li>
</ul>
</li>
</ul>
<ol>
<li>数据清洗
<ul>
<li>调整或移除异常值（可选）</li>
<li>填补缺失值（0，平均数、中位数），或者简单的去掉缺失的样本或特征</li>
</ul>
</li>
<li>特征选择（可选）
<ul>
<li>去掉对本任务无用的信息</li>
</ul>
</li>
<li>特征工程，适度
<ul>
<li>连续数值离散化</li>
<li>特征分解（分类特征、时间特征等）</li>
<li>特征变换（log(x),sqrt(x),x^2等）</li>
<li>特征组合</li>
</ul>
</li>
<li>特征尺度变换：标准化或归一化</li>
</ol>
<h2 id="挑选合适的模型">挑选合适的模型</h2>
<p>建议：</p>
<ul>
<li>如果数据很大，做降采样，以便能够在合理时间内尝试多个模型（不过要注意，这样的操作对于复杂模型不太友好，比如神经网络和随机森林）</li>
<li>再一次的，尽量自动化以上流程</li>
</ul>
<ol>
<li>训练很多模型，快且原始地使用模型参数，训练尽可能多的模型（线性模型、朴素贝叶斯、SVM、随机森林、神经网络等等）</li>
<li>测量并评估他们的表现
<ul>
<li>对于每个模型，使用 N-fold 交叉验证，计算表现的均值与方差</li>
</ul>
</li>
<li>分析每个模型上最为显著的特征</li>
<li>分析模型所犯的错误类型
<ul>
<li>如果是人类，会采用什么样的方法避免犯错？</li>
</ul>
</li>
<li>快速地做一波特征选择和特征工程</li>
<li>前面步骤重复一两次</li>
<li>列出表现最好的3-5个模型，最好他们的错误情况不同以便集成</li>
</ol>
<h2 id="微调系统">微调系统</h2>
<p>建议：</p>
<ul>
<li>随着微调的进行，你将会使用尽可能多的数据</li>
<li>总是使你的操作自动化</li>
</ul>
<ol>
<li>使用交叉验证进行超参数的微调
<ul>
<li>将你的数据变换也变成超参数的一部分，特别是当你对数据不熟悉的时候（比如：我应该用0还是中位数填补缺失值，还是仅仅去掉那个样本？）</li>
<li>除非超参数非常少，使用随机搜索而不是网格搜索。如果训练耗时非常久，你可能会想用贝叶斯优化方法。（比如使用高斯过程）</li>
</ul>
</li>
<li>采用集成方法。集成最优的方案，往往表现会超过单独模型方案。</li>
<li>一旦你对自己的模型很有信心，那就在测试集上验证其泛化误差。</li>
</ol>
<h2 id="方案呈现">方案呈现</h2>
<ol>
<li>记下你所做的努力，文档化</li>
<li>起草一份漂亮的展示稿
<ul>
<li>确保先强调大局</li>
</ul>
</li>
<li>解释为何你的方案达到了商业目标</li>
<li>不要忘记展现整个过程中你认为的有趣部分
<ul>
<li>讲述什么有效、以及什么没起作用</li>
<li>列出你的前提条件，并说明边界</li>
</ul>
</li>
<li>通过可视乎，确保你的关键发现易于理解和传播；或是利用容易记住的表达</li>
</ol>
<h2 id="部署">部署</h2>
<ol>
<li>准备将你的解决方案接入生产环境（接入生产环境的数据，写单元测试等）</li>
<li>写监控代码以监测系统的表现，当系统宕机时发出警告
<ul>
<li>要意识到，随着数据的更新，模型的效果也会衰减</li>
<li>可能需要人工检测数据的表现</li>
<li>同样监控输入数据（例如：失灵的传感器会传回随机的数据，而其他的传感器的输出会是一个稳定值）这对于在线学习系统尤为重要</li>
</ul>
</li>
<li>当模型达到一定偏差时，重新在新数据上训练（尽可能自动化）</li>
</ol>
<p>以上，我们从立项、数据准备、模型准备到模型的部署，全面梳理的真实项目中的机器学习模型生命周期。在真实的工业场景中，我们所作的可能有些许差别，但都差不多。例如：我们会对问题定义、会对数据进行探索、会给需求方呈现我们的解决方案、会监控我们的模型表现。</p>
<p>在梳理过程中我也发现自身团队的不足：对大背景商业目标的认识不到位、很多时候是拿着锤子（模型）去找钉子（场景）、方案呈现上理工科思维偏重、系统迭代不足。除此之外，还有些细节不是很规范。简单来说就是有些跑马圈地、急功近利的感觉。业务向较重，算法模型潜力并未完全释放，在团队内推行以上规范非常有必要。</p>
<p>不知道看本文的读者，你们的团队会有这样的情况吗？欢迎就此在评论区发表你的看法。喜欢本文的读者，别忘了点赞、喜欢、加关注哦，你的鼓励，将是我写作分享的动力(<em>^_^</em>)</p>

    </div>

    <div class="post-copyright">
            
            <p class="copyright-item">
                <span>Author:</span>
                <span>谷粒 </span>
                </p>
            

            
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://kuhungio.me/2019/hands-on_machine_learning_in_industry/>
                        <script>
                            document.write(decodeURI(location.origin + location.pathname))
                        </script>
                    </a>
            </p>
            
            
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>


    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s):
            
            <span class="tag"><a href="https://kuhungio.me/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E8%BF%9B%E9%98%B6/">
                    #机器学习进阶</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> ·
                <span><a href="https://kuhungio.me">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://kuhungio.me/2019/slack-gpt2-bot/" class="prev" rel="prev" title="GPT2 模型生成假正经文稿 Slack gpt2 Bot "><i class="iconfont icon-left"></i>&nbsp;GPT2 模型生成假正经文稿 Slack gpt2 Bot </a>
        
        
        <a href="https://kuhungio.me/2019/vgc-it/" class="next" rel="next" title="如何设计一套类似视觉中国“鹰眼”的技术">如何设计一套类似视觉中国“鹰眼”的技术&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>
</article>
          
<div class="post-comment"><div onclick="showDisqus();" id="disqus_title" class="disqus_title">显示 Disqus 评论</div><div id="gitalk-container" class="gitalk-container"></div>
    <link rel="stylesheet" href="/lib/gitalk/gitalk-1.2.2.min.css">
    <script src="/lib/gitalk/gitalk-1.2.2.min.js"></script>
    <script type="text/javascript">
      var gitalk = new Gitalk({
        id: 'ef52c426a98e3c8aa27e71dc4b105aa8',
        title: '机器学习项目的完整生命周期 Hands On Machine Learning in Industry ',
        clientID: '7e5b8bd7063e5315e349',
        clientSecret: 'd6bd237e0a078b7e343775a47533d7b95d364899',
        repo: 'kuhung.github.io',
        owner: 'kuhung',
        admin: ['kuhung'],
        body: decodeURI(location.href)
      });
      gitalk.render('gitalk-container');
    </script>
    <noscript>Please enable JavaScript to view the
      <a href="https://github.com/gitalk/gitalk">comments powered by gitalk.</a>
    </noscript><div id="disqus_thread"></div>
    <script type="text/javascript">
    function showDisqus() {
      

      
      
      
      

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = false;
      var disqus_shortname = 'kuhungio';
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

      window.location.hash = "#disqus_thread";
    }
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>

          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2016 - 2022</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i>
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://kuhungio.me">谷粒</a> | </span>
         

         
        <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span>
        
    </div>
    <script>
      const currentTheme = window.localStorage && window.localStorage.getItem('theme')
      const isDark = currentTheme === 'dark'
      if (isDark) {
        document.body.classList.add('dark-theme')
      }
    </script>
</footer>












    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>
