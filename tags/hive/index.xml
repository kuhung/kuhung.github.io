<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>hive on Kuhung&#39;s Blog</title>
    <link>https://kuhungio.me/tags/hive/</link>
    <description>Recent content in hive on Kuhung&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <lastBuildDate>Tue, 25 Aug 2020 11:13:05 +0800</lastBuildDate>
    
	<atom:link href="https://kuhungio.me/tags/hive/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Hive å¸¸è§é—®é¢˜é€ŸæŸ¥</title>
      <link>https://kuhungio.me/2020/hive-tricks/</link>
      <pubDate>Tue, 25 Aug 2020 11:13:05 +0800</pubDate>
      
      <guid>https://kuhungio.me/2020/hive-tricks/</guid>
      <description>æ ‡é¢˜ åˆ›å»ºæ—¶é—´ å‘å¸ƒæ—¶é—´ æœ€åä¸€æ¬¡ä¿®æ”¹ å¤‡æ³¨     Hive å¸¸è§é—®é¢˜é€ŸæŸ¥ 2020.08.25 2020.12.21 2021.01.15 /     å‡½æ•°å¤§å…¨ https://www.iteblog.com/archives/2258.html
Hive ç»“æœé‡‡æ · select * from my_table where rand() &amp;lt;= 0.0001 distribute by rand() sort by rand() limit 10000; --- source: http://www.joefkelley.com/736/ è®¡ç®—æ—¶é—´å·® --- https://blog.csdn.net/kent7306/article/details/50441967 --- è®¡ç®—å‰åå·®  --- https://blog.csdn.net/qq_33290422/article/details/81204532 --- ç›´æ¥è®¡ç®—æ—¶é—´å·® json æå– --- refer: https://www.cnblogs.com/drjava/p/10486134.html --- [{&amp;#34;name&amp;#34;:&amp;#34;å¼ ä¸‰&amp;#34;,&amp;#34;sex&amp;#34;:&amp;#34;ç”·&amp;#34;,&amp;#34;age&amp;#34;:&amp;#34;25&amp;#34;},{&amp;#34;name&amp;#34;:&amp;#34;æ&amp;#34;,&amp;#34;sex&amp;#34;:&amp;#34;ç”·&amp;#34;,&amp;#34;age&amp;#34;:&amp;#34;47&amp;#34;}]  SELECT get_json_object(xjson,&amp;#34;$.[0]&amp;#34;) FROM person; --- {&amp;#34;name&amp;#34;:&amp;#34;ç‹äºŒç‹—&amp;#34;,&amp;#34;sex&amp;#34;:&amp;#34;ç”·&amp;#34;,&amp;#34;age&amp;#34;:&amp;#34;25&amp;#34;}  --- æŒ‰å­—æ®µæå– SELECT get_json_object(xjson,&amp;#34;$.</description>
    </item>
    
    <item>
      <title>HIVE æŠ€å·§ç§¯ç´¯ä¹‹åˆå¹¶é‡å æ—¥æœŸ</title>
      <link>https://kuhungio.me/2019/merge_overlapping_date/</link>
      <pubDate>Sun, 09 Jun 2019 00:17:05 +0800</pubDate>
      
      <guid>https://kuhungio.me/2019/merge_overlapping_date/</guid>
      <description>ç›®å‰ç½‘ä¸Šæµä¼ ç€ä¸€ä¸ªæ®µå­ï¼Œè¯´ç®—æ³•å·¥ç¨‹å¸ˆå®é™…ä¸Šå°±æ˜¯ SQL boyï¼Œæ•°æ®åˆ†æå¸ˆæ˜¯ PPT boyã€‚è‰ºæœ¯æ¥æºäºç°å®ï¼Œå®é™…ä¸Šçš„æˆ‘ä»¬çœŸçš„æœ‰å¾ˆå¤šæ—¶é—´åœ¨å†™ SQL å‡ºæ•°æ®ï¼Œæˆ–è€…æ˜¯é’ˆå¯¹ bad case åšæ•°æ®çš„è¿›ä¸€æ­¥åˆ†æã€‚
è¿™ä¸ï¼Œè¿‘æœŸè¿™è¾¹æ¥åˆ°çš„ä¸€ä¸ªéœ€æ±‚å°±æ˜¯å¯¹ç©å®¶çš„æŸé¡¹è¡Œä¸ºè¿›è¡Œç»Ÿè®¡ã€‚ä¸€èˆ¬æ¥è®²ï¼ŒæŒæ¡åŸºæœ¬ SQL çš„æŠ€å·§ï¼Œè¿™äº›éœ€æ±‚çš„éš¾åº¦éƒ½ä¸å¤§ã€‚ä½†æ˜¯è¿™ä¸ªéœ€æ±‚éœ€è¦å°†ç©å®¶ç”¨æˆ·çš„å¤šä¸ªé‡å æ—¥æœŸè¿›è¡Œæ‹‰ä¼¸å»é‡ã€‚è¿™ä¸€ä¸‹å¯éš¾åˆ°å¤§ä¼™å„¿ã€‚åœ¨è‡ªä¸ªå„¿æ€è€ƒæ— æœï¼Œå›¢é˜Ÿè®¨è®ºä¹‹åä¹Ÿæ²¡å•¥ç›´æ¥çš„åŠæ³•ã€‚
åœ¨ç½‘ä¸Šæœç´¢ä¸€ç•ªåï¼Œå¾ˆå¤šéƒ½ä¸æ˜¯å¾ˆå¯¹åº”ã€‚ä¸è¿‡å¥½åœ¨å‡ è½®ç­›é€‰ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªç±»ä¼¼çš„éœ€æ±‚ã€‚åŸæ–‡é“¾æ¥åœ¨è¿™é‡Œï¼šğŸ”—ã€‚ä¸ºäº†æ–¹ä¾¿åæ¥çš„äººï¼Œåœ¨è¿™é‡Œåšä¸ªåˆ†æè®°å½•ï¼Œä»¥åŠåé¢ä¸¾ä¸€åä¸‰è¯¥æ€ä¹ˆåšã€‚æ¯•ç«Ÿè¿™äº›ä¸œè¥¿å¾ˆå°‘å‡ºç°åœ¨æ•™ç¨‹å’Œè¯¾æœ¬é‡Œï¼Œä½†æ˜¯å½“ä¸šåŠ¡æ–¹æœ‰è¿™ä¸ªéœ€æ±‚çš„æ—¶å€™ï¼Œå¸¸å¸¸åˆå¾ˆç´§æ€¥ï¼Œå®¹ä¸å¾—ç»†æ€æ…¢æƒ³ã€‚
é—®é¢˜å®šä¹‰ï¼š åœ¨è§£å†³ä¸€ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ˜ç¡®å®šä¹‰é—®é¢˜ã€‚è¿™é‡Œçš„é—®é¢˜æ˜¯å¯¹å¤šä¸ªé‡å æ—¥æœŸï¼Œç”¨ SQL å°†å…¶è¿›è¡Œå»é‡ï¼Œå¹¶åœ¨ HIVE ç¯å¢ƒä¸­ä½¿ç”¨ã€‚
å¯¹äºæ—¥æœŸæƒ…å†µçš„å®šä¹‰ è¿™é‡Œé‡‡ç”¨ç©·ä¸¾æ³•ï¼Œå¯ä»¥å¾—å‡ºä»¥ä¸‹13ç±»æƒ…å†µï¼š
é—®é¢˜ç®€åŒ– è§£å†³é—®é¢˜çš„æ ¸å¿ƒæ˜¯ç®€åŒ–é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜çœ‹èµ·æ¥æƒ…å†µä¼—å¤šï¼Œå®é™…ä¸Šï¼Œå¯¹äºæˆ‘ä»¬çš„ä»»åŠ¡ï¼Œåªæœ‰ä¸¤ç§æƒ…å†µï¼šä¸€ä¸ªæ˜¯ä¸¤ä¸ªæ—¥æœŸæœ‰é‡å ï¼›ä¸€ä¸ªæ˜¯ä¸¤ä¸ªæ—¥æœŸæ²¡æœ‰é‡å ã€‚
å¯¹äºä¸åŒçš„æƒ…å†µï¼Œè¦åšä¸åŒçš„å¤„ç†ã€‚é‡å æ—¥æœŸå–æœ€å¤§æœ€å°æ—¥æœŸå³å¯ï¼Œéé‡å çš„åˆ†æ®µå–ã€‚å‰©ä¸‹çš„å³æ˜¯é€šè¿‡å·¥å…·å»å®ç°é€»è¾‘ã€‚
æ•°æ®å‡†å¤‡ è¿™é‡Œé‡‡ç”¨åŸä½œçš„æ–¹å¼å®šä¹‰æ•°æ®ï¼Œåˆ›å»ºå‡ºä¸Šé¢çš„13ä¸­æƒ…å†µã€‚å®é™…ä¸Šï¼Œå¦‚æœä½ çš„æ ¼å¼å’Œä¸‹é¢çš„ç±»ä¼¼ï¼Œåšå‡ºå¯¹åº”çš„è°ƒæ•´å³å¯ã€‚
drop table t purge; create table t ( test_case varchar2(32) not null, start_date date not null, end_date date not null ); Insert into t values (&amp;#39;01:precedes&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;01:precedes&amp;#39;,to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;04&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;02:meets&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;02:meets&amp;#39;,to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;03:overlaps&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;03:overlaps&amp;#39;,to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;04&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;04:finished by&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;04:finished by&amp;#39;,to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;05:contains&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;04&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;05:contains&amp;#39;,to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;06:starts&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;06:starts&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;07:equals&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;07:equals&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;08:started by&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;08:started by&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;09:during&amp;#39;,to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;09:during&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;04&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;10:finishes&amp;#39;,to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;10:finishes&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;11:overlapped by&amp;#39;,to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;04&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;11:overlapped by&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;12:met by&amp;#39;,to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;12:met by&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;13:preceded by&amp;#39;,to_date(&amp;#39;03&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;04&amp;#39;,&amp;#39;DD&amp;#39;)); Insert into t values (&amp;#39;13:preceded by&amp;#39;,to_date(&amp;#39;01&amp;#39;,&amp;#39;DD&amp;#39;),to_date(&amp;#39;02&amp;#39;,&amp;#39;DD&amp;#39;)); commit; å®šä¹‰å‡ºæ¥çš„æ•°æ®å¦‚ä¸‹</description>
    </item>
    
  </channel>
</rss>